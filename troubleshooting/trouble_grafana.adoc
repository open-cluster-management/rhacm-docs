[#troubleshooting-grafana]
= Troubleshooting grafana

When you query some time-consuming metrics in the grafana explorer, you may encounter `Gateway Time-out` error.

[#symptom-grafana-explorer-gateway-timeout]
== Symptom: Grafana explorer gateway timeout

If you hit the `Gateway Time-out` error when you query some time-consuming metrics in the grafana explorer, it is possible that the timeout is caused by the route `multicloud-console` in the namespace `open-cluster-management`.

[#resolving-grafana-explorer-gateway-timeout]
== Resolving the problem: Grafana explorer gateway timeout

If you have this problem, complete the following steps:

. Verify that the default configuration of grafana has expected timeout settings:
.. To verify that the default timeout setting of grafana, run the following command:
+
----
oc get secret grafana-config -n open-cluster-management-observability -o jsonpath="{.data.grafana\.ini}" | base64 -d | grep dataproxy -A 4
----
The following timeout settings should be displayed:
+
----
[dataproxy]
timeout = 300
dial_timeout = 30
keep_alive_seconds = 300
----
.. To verify that the default datasource query timeout for grafana, run the following command: 
+
----
oc get secret/grafana-datasources -n open-cluster-management-observability -o jsonpath="{.data.datasources\.yaml}" | base64 -d | grep queryTimeout
----
+
The following timeout settings should be displayed:
+
----
queryTimeout: 300s
----
. If you verified the default configuration of grafana has expected timeout settings, then you can configure the route `multicloud-console` in the namespace `open-cluster-management` by running the following commmand:
+
----
oc annotate route multicloud-console -n open-cluster-management --overwrite haproxy.router.openshift.io/timeout=300s
----

Then you try to refresh the Grafana page and try to query the matrics again, the `Gateway Time-out` error is supposed to be gone.
